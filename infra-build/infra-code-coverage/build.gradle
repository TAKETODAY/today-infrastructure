plugins {
  id 'base'
  id 'jacoco-report-aggregation'
}

description = "Code Coverage"

dependencies {
  jacocoAggregation(enforcedPlatform(project(":infra-dependencies")))

  jacocoAggregation project(':infra-app')

  jacocoAggregation project(':infra-core')
  jacocoAggregation project(':infra-beans')
  jacocoAggregation project(':infra-aop')
  jacocoAggregation project(':infra-context')
  jacocoAggregation project(':infra-aspects')
  jacocoAggregation project(':infra-context-indexer')
  jacocoAggregation project(':infra-context-support')
  jacocoAggregation project(':infra-core-aot')
  jacocoAggregation project(':infra-expression')
  jacocoAggregation project(':infra-core-test')
  jacocoAggregation project(':infra-jcache')
  jacocoAggregation project(':infra-jdbc')
  jacocoAggregation project(':infra-persistence')
  jacocoAggregation project(':infra-oxm')
  jacocoAggregation project(':infra-test')
  jacocoAggregation project(':infra-test-support')
  jacocoAggregation project(':infra-tx')
  jacocoAggregation project(':infra-web')
  jacocoAggregation project(':infra-webmvc')
  jacocoAggregation project(':infra-websocket')
  jacocoAggregation project(':integration-tests')

  jacocoAggregation project(':infra-http')
  jacocoAggregation project(':infra-http-client')
  jacocoAggregation project(':infra-http-codec')
  jacocoAggregation project(':infra-http-converter')
  jacocoAggregation project(':infra-http-reactive')
  jacocoAggregation project(':infra-web-client')
  jacocoAggregation project(':infra-web-core')
  jacocoAggregation project(':infra-web-reactive')
  jacocoAggregation project(':infra-http-service')

  jacocoAggregation project(':module:infra-freemarker')
  jacocoAggregation project(':module:infra-groovy-templates')
  jacocoAggregation project(':module:infra-app-resttestclient')
  jacocoAggregation project(':module:infra-app-health')
  jacocoAggregation project(':module:infra-app-test')
  jacocoAggregation project(':module:infra-gson')
  jacocoAggregation project(':module:infra-jsonb')
  jacocoAggregation project(':module:infra-jackson')
  jacocoAggregation project(':module:infra-mail')
  jacocoAggregation project(':module:infra-sql')
  jacocoAggregation project(':module:infra-flyway')

  jacocoAggregation project(':infra-web-netty-server')
  jacocoAggregation project(':infra-web-reactor-server')
  jacocoAggregation project(':infra-web-server')
}

reporting {
  reports {
    testCodeCoverageReport(JacocoCoverageReport) {
      testSuiteName = "test"
    }
  }
}

testCodeCoverageReport.dependsOn(check)
