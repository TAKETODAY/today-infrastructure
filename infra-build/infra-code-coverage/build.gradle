plugins {
  id 'base'
  id 'jacoco-report-aggregation'
}

description = "Code Coverage"

dependencies {
  jacocoAggregation(enforcedPlatform(project(":infra-dependencies")))

  jacocoAggregation project(':infra-app')

  jacocoAggregation project(':infra-core')
  jacocoAggregation project(':infra-beans')
  jacocoAggregation project(':infra-aop')
  jacocoAggregation project(':infra-context')
  jacocoAggregation project(':infra-aspects')
  jacocoAggregation project(':infra-context-indexer')
  jacocoAggregation project(':infra-context-support')
  jacocoAggregation project(':infra-core-aot')
  jacocoAggregation project(':infra-expression')
  jacocoAggregation project(':infra-core-test')
  jacocoAggregation project(':infra-jcache')
  jacocoAggregation project(':infra-jdbc')
  jacocoAggregation project(':infra-oxm')
  jacocoAggregation project(':infra-test')
  jacocoAggregation project(':infra-test-support')
  jacocoAggregation project(':infra-tx')
  jacocoAggregation project(':infra-web')
  jacocoAggregation project(':infra-webmvc')
  jacocoAggregation project(':infra-websocket')
  jacocoAggregation project(':integration-tests')

  jacocoAggregation project(':infra-http')
  jacocoAggregation project(':infra-http-client')
  jacocoAggregation project(':infra-http-codec')
  jacocoAggregation project(':infra-http-converter')
  jacocoAggregation project(':infra-http-reactive')
  jacocoAggregation project(':infra-web-client')
  jacocoAggregation project(':infra-web-core')
  jacocoAggregation project(':infra-web-reactive')
  jacocoAggregation project(':infra-http-service')

  jacocoAggregation project(':infra-app-config')
  jacocoAggregation project(':module:infra-app-freemarker')
  jacocoAggregation project(':module:infra-app-gson')
  jacocoAggregation project(':module:infra-app-health')
  jacocoAggregation project(':module:infra-app-http-client')
  jacocoAggregation project(':module:infra-app-http-codec')
  jacocoAggregation project(':module:infra-app-http-converter')
  jacocoAggregation project(':module:infra-app-jackson')
  jacocoAggregation project(':module:infra-app-jdbc')
  jacocoAggregation project(':module:infra-app-jsonb')
  jacocoAggregation project(':module:infra-app-mail')
  jacocoAggregation project(':module:infra-app-netty-server')
  jacocoAggregation project(':module:infra-app-reactor-netty')
  jacocoAggregation project(':module:infra-app-restclient')
  jacocoAggregation project(':module:infra-app-transaction')
  jacocoAggregation project(':module:infra-app-validation')
  jacocoAggregation project(':module:infra-app-web-server')
  jacocoAggregation project(':module:infra-app-webclient')
  jacocoAggregation project(':module:infra-app-webmvc')
  jacocoAggregation project(':module:infra-app-websocket')
}

reporting {
  reports {
    testCodeCoverageReport(JacocoCoverageReport) {
      testSuiteName = "test"
    }
  }
}

testCodeCoverageReport.dependsOn(check)
